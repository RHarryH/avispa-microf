<!--
  ~ Avispa μF - invoice generating software built on top of Avispa ECM
  ~ Copyright (C) 2023 Rafał Hiszpański
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program.  If not, see <https://www.gnu.org/licenses/>.
  -->

<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
    <body>
        <div th:id="${listWidgetDto.resourceId + '-list-widget'}" class="py-3" th:fragment="list-widget(listWidgetDto)">
            <button th:id="${listWidgetDto.resourceId + '-list-refresh-button'}" type="button" class="btn btn-sm btn-outline-dark mb-2 bi bi-arrow-clockwise"> Refresh</button>
            <table class="table table-striped">
                <caption th:text="${listWidgetDto.caption}">Caption</caption>
                <thead>
                <tr>
                    <th scope="col" th:each="header : ${listWidgetDto.headers}" th:if="${header != 'pdfRenditionAvailable'}" th:text="${header}">Header</th>
                    <th scope="col">Edit</th>
                    <th scope="col">Delete</th>
                    <th scope="col" th:if="${listWidgetDto.isDocument}">Download</th>
                </tr>
                </thead>
                <tbody>
                <tr th:if="${listWidgetDto.dataList.empty}">
                    <td colspan="100%" th:text="${listWidgetDto.emptyMessage}">Empty message</td>
                </tr>
                <tr th:each="data : ${listWidgetDto.dataList}">
                    <td th:each="value : ${data.values}" th:if="${value.key != 'pdfRenditionAvailable'}">
                        <span th:text="${value.value}">Property</span>
                    </td>
                    <td>
                        <button th:value="${data.id}" class="btn bi bi-pencil-fill" th:classappend="${listWidgetDto.resourceId + '-update-button'}" type="button" data-bs-toggle="tooltip" data-bs-placement="bottom" th:title="${'Edit ' + listWidgetDto.typeName}"></button>
                    </td>
                    <td>
                        <span data-bs-toggle="modal" th:data-bs-target="${'#' + listWidgetDto.resourceId + '-delete-modal'}">
                            <button th:value="${data.id}" class="btn bi bi-trash-fill" th:classappend="${listWidgetDto.resourceId + '-delete-button'}" type="button" data-bs-toggle="tooltip" data-bs-placement="bottom" th:title="${'Delete ' + listWidgetDto.typeName}"></button>
                        </span>
                    </td>
                    <td th:if="${listWidgetDto.isDocument}">
                        <form th:if="${data.values.get('pdfRenditionAvailable')}" th:action="@{/{type}/rendition/{id}(type = ${listWidgetDto.resourceId}, id = ${data.id})}" method="get">
                            <button class="btn bi bi-file-earmark-arrow-down-fill" type="submit" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Download PDF rendition"></button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>

            <th:block th:replace="fragments/modal :: modal(${listWidgetDto.resourceId + '-delete-modal'}, 'Deletion', ${'Do you really want to delete this ' +  listWidgetDto.typeName + '?'})">modal</th:block>
        </div>
    </body>
</html>